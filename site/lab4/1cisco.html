<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. 实验目的 &mdash; 计算机网络实验指导书 - 2022春季 | 哈工大（深圳） v1.0 文档</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/my_style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
        <script src="../_static/js/baidu-tongji.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Lab2：协议栈之Eth协议实现" href="../lab2/index.html" />
    <link rel="prev" title="Lab1：VLAN 与接口模式配置" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> 计算机网络实验指导书 - 2022春季 | 哈工大（深圳）
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">实验</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../lab0/index.html">计算机网络实验概述</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Lab1：VLAN 与接口模式配置</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1. 实验目的</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">2. 实验任务</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">3. 实验原理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vlan">3.1. VLAN概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">3.2. VLAN帧格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">3.3. VLAN端口的分类</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#access">3.3.1. Access端口</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trunk">3.3.2. Trunk端口</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id6">4. 实验环境与分组</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">5. 实验组网</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">6. 实验步骤</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">6.1. 搭建网络拓扑</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vlan2">6.2. 进入交换机配置vlan2添加相应接口</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#swtich0">6.2.1. 进入Swtich0的用户模式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#switch0vlan-2">6.2.2. 配置Switch0的VLAN 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#switch0vlan">6.2.3. 观察配置Switch0的VLAN信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="#switch1vlan-2">6.2.4. 配置Switch1的VLAN 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#switch1vlan">6.2.5. 观察Switch1的VLAN信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ip">6.2.6. 设置计算机的IP地址</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vlanvlan">6.2.7. 观察同一VLAN和不同VLAN的连通情况</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vlan3ip">6.3. 进入交换机配置vlan3接口ip并观察连通性</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#switch0vlan-3">6.3.1. 配置Switch0的VLAN 3</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">6.3.2. 观察Switch0的VLAN信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="#switch1vlan-3">6.3.3. 配置Switch1的VLAN 3</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">6.3.4. 观察Switch1的VLAN信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vlan-3">6.3.5. 观察同一VLAN 3的连通情况</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id12">6.4. 配置接口trunk模式并验证连通性</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#switch0switch1trunk">6.4.1. 配置Switch0和Switch1的trunk端口</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">6.4.2. 观察VLAN 3的连通情况</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14">6.4.3. 观察同一VLAN和不同VLAN的连通情况</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lab2/index.html">Lab2：协议栈之Eth协议实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab3/index.html">Lab3：协议栈之ARP协议实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab8/index.html">Lab4：RIP路由配置及协议分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab5/index.html">Lab5：协议栈之IP协议实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab6/index.html">Lab6：协议栈之ICMP协议实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab7/index.html">Lab7：协议栈之UDP协议实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab10/index.html">Lab8：NAT组网</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab9/index.html">Lab9：邮件客户端的设计与实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proplus/index.html">附加题</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">附录</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix-a/index.html">附录 A：Wireshark 入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix-b/index.html">附录 B：网络编程实验环境</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix-c/index.html">附录 C：Cisco Packet Tracer简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix-d/index.html">附录 D：参考文献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix-e/index.html">附录 E：致谢</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">计算机网络实验指导书 - 2022春季 | 哈工大（深圳）</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Lab1：VLAN 与接口模式配置</a> &raquo;</li>
      <li><span class="section-number">1. </span>实验目的</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/lab4/1cisco.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1><span class="section-number">1. </span>实验目的<a class="headerlink" href="#id1" title="永久链接至标题"></a></h1>
<ol class="arabic simple">
<li><p>了解VLAN（虚拟局域网）的作用；</p></li>
<li><p>掌握跨交换机的VLAN的配置方法；</p></li>
<li><p>掌握trunk端口的配置方法；</p></li>
<li><p>了解VLAN数据帧的格式、VLAN标记添加和删除的过程。</p></li>
</ol>
</section>
<section id="id2">
<h1><span class="section-number">2. </span>实验任务<a class="headerlink" href="#id2" title="永久链接至标题"></a></h1>
<p>本实验模拟某公司网络场景。该公司规模较大，内部放置了两台接入交换机（SW2和SW3）负责员工的网络接入，而且在交换机上划分不同VLAN来隔离广播域。由于员工较多，相同部分的员工通过不同交换机接入。为了保证在不同交换机下相同部门的员工能相互通信，需要配置交换机之间的链路为干道（trunk）模式，以实现相同VLAN跨交换机通信。</p>
</section>
<section id="id3">
<h1><span class="section-number">3. </span>实验原理<a class="headerlink" href="#id3" title="永久链接至标题"></a></h1>
<section id="vlan">
<h2><span class="section-number">3.1. </span>VLAN概要<a class="headerlink" href="#vlan" title="永久链接至标题"></a></h2>
<p>由一台或多台交换机/集线器所组成的1个广播域称为扁平网络（flat network）。相互连接的硬件会接收有网络发来的广播帧。因此，随着连接硬件数量的增加，广播数据也会增加，网络状况也就越发混杂。为了减少广播数据，可以采用将整个扁平网络进行逻辑分段的VLAN（Virtual LAN）技术——一种专门为隔离二层广播报文设计的虚拟局域网技术。在一个VLAN中使用同一个广播域，不同的VLAN用户属于不同的广播域，它不能接收来
自于不同VLAN用户的广播报文，因此可以有效地控制该域内广播通信的规模。</p>
<img alt="../_images/VLAN广播域.png" src="../_images/VLAN广播域.png" />
<div class="admonition hint">
<p class="admonition-title">提示</p>
<p>网络中将传播过多的广播信息而引起的网络性能恶化的现象称为广播风暴。广播帧属于二层并不会跨越三层，所以为了解决广播风暴，可以使用三层设备隔离广播域，减小广播域范围，比如可以使用路由器来隔离广播域，但由于路由器属于三层设备，对数据的转发容易形成瓶颈，因此一般使用VLAN来隔离广播域。</p>
</div>
</section>
<section id="id4">
<h2><span class="section-number">3.2. </span>VLAN帧格式<a class="headerlink" href="#id4" title="永久链接至标题"></a></h2>
<p>当某个VLAN需要跨越多个交换机通信时，一般会使用 <strong>中继端口（trunk port）</strong> 的VLAN标签（tag VLAN）。IEEE 802.1Q标准规定在原有的标准以太网帧格式上增加一个特殊的标志域——tag域，用于表示数据帧所属的VLAN ID，带有VLAN标签的数据包可以通过中继端口完成以太网数据帧的收发。</p>
<img alt="../_images/VLAN帧.png" src="../_images/VLAN帧.png" />
<p>在以太网中，TPID的值为0x8100。如果该值不是0x8100，那么该域则不是表示TPID信息，而是被当作“长度/类型”数据域被识别。</p>
<p>TCI又分为PCP、CFI和VLAN ID三个域。</p>
<ul class="simple">
<li><p>PCP（Priority Code Point）：该域占用3个bit位，用于标识数据帧的优先级。</p></li>
<li><p>CFI（Canonical Format Indicator）：该域仅占用1bit 位，如果该位为0，表示该数据帧采用规范帧格式，如果该位为1，表示该数据帧为非规范帧格式。</p></li>
<li><p>VLAN ID：该域占用12个 bit 位，它明确指出该数据帧属于某一个VLAN。0仅用于识别PCP中表示的优先级，4095（0xFFF）为预留值，所以VLAN ID 表示的范围为 1-4094。</p></li>
</ul>
<img alt="../_images/VLAN转发.png" src="../_images/VLAN转发.png" />
</section>
<section id="id5">
<h2><span class="section-number">3.3. </span>VLAN端口的分类<a class="headerlink" href="#id5" title="永久链接至标题"></a></h2>
<p>根据端口对 VLAN 数据帧的处理方式，cisco交换机的端口分为 Access port和Trunk port两类。</p>
<section id="access">
<h3><span class="section-number">3.3.1. </span>Access端口<a class="headerlink" href="#access" title="永久链接至标题"></a></h3>
<p>Access 端口一般是指那些连接不支持 VLAN 技术的终端设备的端口，这些端口接收到的数据帧都不包含 VLAN 标签，而向外发送数据帧时，必须保证数据帧中也不包含 VLAN 标签。交换机的Access 端口一般接主机或路由器。</p>
<p><strong>Access端口收报文</strong> ：收到一个报文,判断是否有VLAN标签：如果没有则打上端口的PVID（默认VLAN），并进行交换转发,如果有则直接丢弃（缺省）；</p>
<p><strong>Access端口发报文</strong> ：将报文的VLAN信息剥离，直接发送出去。</p>
<img alt="../_images/access.png" src="../_images/access.png" />
</section>
<section id="trunk">
<h3><span class="section-number">3.3.2. </span>Trunk端口<a class="headerlink" href="#trunk" title="永久链接至标题"></a></h3>
<p>Trunk 端口一般是指那些连接支持 VLAN 技术的网络设备（如交换机）的端口，这些端口接收到的数据帧一般都包含 VLAN 标签（数据帧 VLAN ID 和端口缺省 VLAN ID 相同除外），而向外发送数据帧时，必须保证接收端能够区分不同 VLAN 的数据帧，故常常需要添加 VLAN 标签（数据帧 VLAN ID 和端口缺省 VLAN ID 相同除外）。一般用于交换机之间的连接。</p>
<p><strong>Trunk端口收报文</strong> ：收到一个报文，判断是否有VLAN标签。如果没有则打上端口的PVID（默认VLAN），再进行交换转发；如果有判断该trunk端口是否允许该 VLAN的数据进入，如果可以则转发，否则丢弃；</p>
<p><strong>Trunk端口发报文</strong> ：比较端口的PVID（默认VLAN）和将要发送报文的VLAN标签，如果两者相等则剥离VLAN标签，再发送，如果不相等则直接发送。</p>
<img alt="../_images/trunk.png" src="../_images/trunk.png" />
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>以太网交换机带VLAN标签的帧转发说明</strong></p>
<p>当交换机某个端口接收到的数据帧，首先，检查该数据帧是否带VLAN标签，如果没有，则将该端口缺省VLAN ID（pvid）作为其VLAN ID，如果带VLAN标签，则检查是否在允许列表里面，若不在则丢弃该数据帧。接下来，交换机结合VLAN ID进行源MAC地址学习，更新MAC地址表。然后，根据该数据帧的目的MAC地址和VLAN ID，查找MAC地址表并向相应端口转发该数据帧。最后，在发送数据帧的端口，需要根据该VLAN ID的类型（Tagged或Untagged ）来决定是否将VLAN标签去掉，然后发送数据帧。</p>
<p>（更多关于VLAN帧转发详见参考文献中的《计算机网络实验教程》以及《奠基·计算机网络（华为微课版）》）</p>
</div>
</section>
</section>
</section>
<section id="id6">
<h1><span class="section-number">4. </span>实验环境与分组<a class="headerlink" href="#id6" title="永久链接至标题"></a></h1>
<p>cisco packet tracer模拟器，一人一组。</p>
</section>
<section id="id7">
<h1><span class="section-number">5. </span>实验组网<a class="headerlink" href="#id7" title="永久链接至标题"></a></h1>
<img alt="../_images/cisco组网图.png" src="../_images/cisco组网图.png" />
</section>
<section id="id8">
<h1><span class="section-number">6. </span>实验步骤<a class="headerlink" href="#id8" title="永久链接至标题"></a></h1>
<section id="id9">
<h2><span class="section-number">6.1. </span>搭建网络拓扑<a class="headerlink" href="#id9" title="永久链接至标题"></a></h2>
<p>打开Cisco Packet Tracer软件(Cisco Packet Tracer 绿色版\bin\PacketTracer7.exe)。在底部工具栏区域，选择“Network Devices”，点击“Swithes”，将二层交换机“2960-24TT”拖拽到空白工作区中（需要拖拽两台二层交换机）。</p>
<a class="reference internal image-reference" href="../_images/conf-1.png"><img alt="../_images/conf-1.png" src="../_images/conf-1.png" style="width: 470.40000000000003px; height: 132.8px;" /></a>
<p>接着，在底部工具栏区域，选择“End Devices”，点击最下一栏的“End Devices”，将计算机设备“PC”拖拽到空白工作区中（需要拖拽4台PC机）。</p>
<a class="reference internal image-reference" href="../_images/conf-2.png"><img alt="../_images/conf-2.png" src="../_images/conf-2.png" style="width: 608.0px; height: 132.8px;" /></a>
<p>拖拽完成后如下图所示。</p>
<a class="reference internal image-reference" href="../_images/conf-3.png"><img alt="../_images/conf-3.png" src="../_images/conf-3.png" style="width: 586.4px; height: 350.40000000000003px;" /></a>
<p>单击“Connections”，选择“Copper Straight-Through(直通线)”并单击。</p>
<a class="reference internal image-reference" href="../_images/conf-4.png"><img alt="../_images/conf-4.png" src="../_images/conf-4.png" style="width: 563.2px; height: 134.4px;" /></a>
<p>再单击PC0图标，再弹出的菜单中选择FastEthernet0选项。</p>
<a class="reference internal image-reference" href="../_images/conf-5.png"><img alt="../_images/conf-5.png" src="../_images/conf-5.png" style="width: 205.60000000000002px; height: 142.4px;" /></a>
<p>再单击二层交换机“2960-24TT” Switch0，再弹出的菜单中选择FastEthernet0/11选项。</p>
<a class="reference internal image-reference" href="../_images/conf-6.png"><img alt="../_images/conf-6.png" src="../_images/conf-6.png" style="width: 376.8px; height: 704.0px;" /></a>
<p>这时可以看到计算机PC0已经连接到Switch0上，但看不出是哪两个端口相连。在模拟器主界面的菜单栏上选择Option -&gt; Preferences命令，打开Preferences对话框，在“Interface”选项卡中勾选“Always Show Port Labels in Logical Workspace”复选框即可显示接口名称。</p>
<a class="reference internal image-reference" href="../_images/conf-7.png"><img alt="../_images/conf-7.png" src="../_images/conf-7.png" style="width: 779.2px; height: 742.4000000000001px;" /></a>
<p>继续用 <strong>Copper Straight-Through(直通线)</strong> 将PC1与Switch0的f0/12连接一起，将PC2和PC3分别与Switch1的f0/13和f0/14连接在一起。</p>
<p>将Switch0和Switch1用 <strong>Copper Cross Over(交叉线)</strong> 进行连接。</p>
<a class="reference internal image-reference" href="../_images/conf-8.png"><img alt="../_images/conf-8.png" src="../_images/conf-8.png" style="width: 563.2px; height: 133.6px;" /></a>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Copper Straight-Through(直通线)</strong> ：用于连接不同类型的网络设备，如计算机与交换机、交换机与路由器。</p>
<p><strong>Copper Cross Over(交叉线)</strong> : 用于连接相同类型的网络设备，如计算机和路由器、路由器和路由器、交换机和交换机、计算机和计算机。</p>
<p>目前绝大部分网络设备支持MDI/MDIX功能，能够实现线缆自适应，也就是连接时使用直通线或交叉线都可以。但 <strong>在Cisco Packet Tracer中仍要严格遵守连线类型</strong> 。</p>
</div>
<p>连接完成的组网图如下图所示。</p>
<a class="reference internal image-reference" href="../_images/conf-9.png"><img alt="../_images/conf-9.png" src="../_images/conf-9.png" style="width: 594.4px; height: 344.8px;" /></a>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>组网图搭建完成后，建议先 <strong>保存</strong> 起来，以免在后续的操作过程中Cisco Packet Tracer模拟器突然挂了：）</p>
</div>
</section>
<section id="vlan2">
<h2><span class="section-number">6.2. </span>进入交换机配置vlan2添加相应接口<a class="headerlink" href="#vlan2" title="永久链接至标题"></a></h2>
<section id="swtich0">
<h3><span class="section-number">6.2.1. </span>进入Swtich0的用户模式<a class="headerlink" href="#swtich0" title="永久链接至标题"></a></h3>
<p>单击Switch0图标，在弹出的窗口里点击“CLI”选项卡，在“IOS Command Line Interface”工作区中敲回车键，进入交换机的用户模式</p>
<a class="reference internal image-reference" href="../_images/conf-10.png"><img alt="../_images/conf-10.png" src="../_images/conf-10.png" style="width: 525.6px; height: 504.0px;" /></a>
</section>
<section id="switch0vlan-2">
<h3><span class="section-number">6.2.2. </span>配置Switch0的VLAN 2<a class="headerlink" href="#switch0vlan-2" title="永久链接至标题"></a></h3>
<p>在Switch0交换机上使用下列命令进行VLAN配置：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>Switch&gt;enable   //进入交换机特权模式
<span class="linenos"> 2</span>Switch#configure terminal  // 进入交换机全局模式（也称为config模式）
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>Switch<span class="o">(</span>config<span class="o">)</span><span class="c1">#  // 全局模式的提示符是“(config)#”</span>
<span class="linenos"> 5</span>Switch<span class="o">(</span>config<span class="o">)</span><span class="c1"># hostname Switch0 // 更改交换机的主机名</span>
<span class="linenos"> 6</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#no ip domain-lookup  // 用于防止DNS解析的命令。如果没有这条命令，当你输入错误的命令时，cisco会尝试连接DNS服务器进行域名解析，浪费时间。</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#vlan 2  // 创建vlan 2</span>
<span class="linenos"> 9</span>Switch0<span class="o">(</span>config-vlan<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">10</span>
<span class="linenos">11</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/11 // 进入f0/11接口模式</span>
<span class="linenos">12</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport access vlan 2 //将f0/11端口划分给vlan 2</span>
<span class="linenos">13</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">14</span>
<span class="linenos">15</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/4  // 进入f0/4接口模式</span>
<span class="linenos">16</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport access vlan 2 //将f0/4端口划分给vlan 2</span>
<span class="linenos">17</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">18</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">19</span>Switch0#
</pre></div>
</div>
</section>
<section id="switch0vlan">
<h3><span class="section-number">6.2.3. </span>观察配置Switch0的VLAN信息<a class="headerlink" href="#switch0vlan" title="永久链接至标题"></a></h3>
<p>在Switch0上查看划分的vlan信息：</p>
<a class="reference internal image-reference" href="../_images/conf-11.png"><img alt="../_images/conf-11.png" src="../_images/conf-11.png" style="width: 677.6px; height: 496.8px;" /></a>
</section>
<section id="switch1vlan-2">
<h3><span class="section-number">6.2.4. </span>配置Switch1的VLAN 2<a class="headerlink" href="#switch1vlan-2" title="永久链接至标题"></a></h3>
<p>在Switch1交换机上使用下列命令进行VLAN配置：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>Switch&gt;enable   //进入系统视图
<span class="linenos"> 2</span>Switch#configure terminal
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>Switch<span class="o">(</span>config<span class="o">)</span><span class="c1">#</span>
<span class="linenos"> 5</span>Switch<span class="o">(</span>config<span class="o">)</span><span class="c1"># hostname Switch1 // 更改交换机的主机名</span>
<span class="linenos"> 6</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#no ip domain-lookup  // 用于防止DNS解析的命令。</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#vlan 2  //创建vlan 2</span>
<span class="linenos"> 9</span>Switch1<span class="o">(</span>config-vlan<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">10</span>
<span class="linenos">11</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/13</span>
<span class="linenos">12</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport access vlan 2 //将f0/13端口划分给vlan 2</span>
<span class="linenos">13</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">14</span>
<span class="linenos">15</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/4</span>
<span class="linenos">16</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport access vlan 2 //将f0/4端口划分给vlan 2</span>
<span class="linenos">17</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">18</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">19</span>Switch1#
</pre></div>
</div>
</section>
<section id="switch1vlan">
<h3><span class="section-number">6.2.5. </span>观察Switch1的VLAN信息<a class="headerlink" href="#switch1vlan" title="永久链接至标题"></a></h3>
<p>在Switch1上查看划分的vlan信息：</p>
<a class="reference internal image-reference" href="../_images/conf-14.png"><img alt="../_images/conf-14.png" src="../_images/conf-14.png" style="width: 666.4000000000001px; height: 498.40000000000003px;" /></a>
</section>
<section id="ip">
<h3><span class="section-number">6.2.6. </span>设置计算机的IP地址<a class="headerlink" href="#ip" title="永久链接至标题"></a></h3>
<p>为PC0~PC3配置IP地址，如下表所示。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 42%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>设备</p></th>
<th class="head"><p>IP地址</p></th>
<th class="head"><p>子网掩码</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PC0</p></td>
<td><p>192.168.2.11</p></td>
<td><p>255.255.255.0</p></td>
</tr>
<tr class="row-odd"><td><p>PC1</p></td>
<td><p>192.168.3.12</p></td>
<td><p>255.255.255.0</p></td>
</tr>
<tr class="row-even"><td><p>PC2</p></td>
<td><p>192.168.2.13</p></td>
<td><p>255.255.255.0</p></td>
</tr>
<tr class="row-odd"><td><p>PC3</p></td>
<td><p>192.168.3.14</p></td>
<td><p>255.255.255.0</p></td>
</tr>
</tbody>
</table>
<p>单击PC0图标，在弹出的窗口中，选择Desktop选项卡，点击“IP Configuration”图标。</p>
<a class="reference internal image-reference" href="../_images/conf-15-1.png"><img alt="../_images/conf-15-1.png" src="../_images/conf-15-1.png" style="width: 681.6px; height: 601.6px;" /></a>
<p>在弹出的窗口中选择“Interface”栏，设置该端口的IP地址和子网掩码，如下图所示。</p>
<a class="reference internal image-reference" href="../_images/conf-15-2.png"><img alt="../_images/conf-15-2.png" src="../_images/conf-15-2.png" style="width: 681.6px; height: 601.6px;" /></a>
<p>可参照PC0的配置方式来配置PC1、PC2和PC3的IP地址。</p>
</section>
<section id="vlanvlan">
<h3><span class="section-number">6.2.7. </span>观察同一VLAN和不同VLAN的连通情况<a class="headerlink" href="#vlanvlan" title="永久链接至标题"></a></h3>
<p>单击PC0，在Desktop选项卡中，单击“Command Prompt”选项，则可进入命令行模式。</p>
<a class="reference internal image-reference" href="../_images/conf-16.png"><img alt="../_images/conf-16.png" src="../_images/conf-16.png" style="width: 708.8000000000001px; height: 488.0px;" /></a>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p><strong>实验测试</strong></p>
<p>PC0和PC2属于同一VLAN，用PC0 ping PC2的IP地址192.168.2.13，看看是否相通？</p>
<p>PC1和PC3没有配置VLAN，用PC1 ping PC3的IP地址192.168.3.14，看看是否相通？</p>
</div>
<a class="reference internal image-reference" href="../_images/conf-17.png"><img alt="../_images/conf-17.png" src="../_images/conf-17.png" style="width: 681.6px; height: 376.0px;" /></a>
</section>
</section>
<section id="vlan3ip">
<h2><span class="section-number">6.3. </span>进入交换机配置vlan3接口ip并观察连通性<a class="headerlink" href="#vlan3ip" title="永久链接至标题"></a></h2>
<section id="switch0vlan-3">
<h3><span class="section-number">6.3.1. </span>配置Switch0的VLAN 3<a class="headerlink" href="#switch0vlan-3" title="永久链接至标题"></a></h3>
<p>在Switch0交换机上的系统视图下使用下列命令进行配置：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>Switch0&gt;enable
<span class="linenos"> 2</span>Switch0#configure terminal
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#vlan 3  //创建vlan 3</span>
<span class="linenos"> 5</span>Switch0<span class="o">(</span>config-vlan<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos"> 6</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/12</span>
<span class="linenos"> 9</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport access vlan 3 //将f0/12端口划分给vlan 3</span>
<span class="linenos">10</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">11</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">12</span>Switch0#
</pre></div>
</div>
</section>
<section id="id10">
<h3><span class="section-number">6.3.2. </span>观察Switch0的VLAN信息<a class="headerlink" href="#id10" title="永久链接至标题"></a></h3>
<p>在Switch0上使用“show vlan”命令查看VLAN的信息。</p>
<a class="reference internal image-reference" href="../_images/conf-18.png"><img alt="../_images/conf-18.png" src="../_images/conf-18.png" style="width: 671.2px; height: 244.0px;" /></a>
</section>
<section id="switch1vlan-3">
<h3><span class="section-number">6.3.3. </span>配置Switch1的VLAN 3<a class="headerlink" href="#switch1vlan-3" title="永久链接至标题"></a></h3>
<p>在Switch1交换机上的系统视图下使用下列命令进行配置：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>Switch1&gt;enable
<span class="linenos"> 2</span>Switch1#configure terminal
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#vlan 3  //创建vlan 3</span>
<span class="linenos"> 5</span>Switch1<span class="o">(</span>config-vlan<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos"> 6</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/14</span>
<span class="linenos"> 9</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport access vlan 3 //将f0/14端口划分给vlan 3</span>
<span class="linenos">10</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">11</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">12</span>Switch1#
</pre></div>
</div>
</section>
<section id="id11">
<h3><span class="section-number">6.3.4. </span>观察Switch1的VLAN信息<a class="headerlink" href="#id11" title="永久链接至标题"></a></h3>
<p>在Switch1上使用“show vlan”命令查看VLAN的信息。</p>
<a class="reference internal image-reference" href="../_images/conf-19.png"><img alt="../_images/conf-19.png" src="../_images/conf-19.png" style="width: 656.0px; height: 243.20000000000002px;" /></a>
</section>
<section id="vlan-3">
<h3><span class="section-number">6.3.5. </span>观察同一VLAN 3的连通情况<a class="headerlink" href="#vlan-3" title="永久链接至标题"></a></h3>
<p>验证测试：在PC1上ping PC3验证连通性，还是没有ping通。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>由于VLAN技术的隔离，网络设备都处于不连通状态。</p>
</div>
<a class="reference internal image-reference" href="../_images/conf-20.png"><img alt="../_images/conf-20.png" src="../_images/conf-20.png" style="width: 681.6px; height: 332.8px;" /></a>
</section>
</section>
<section id="id12">
<h2><span class="section-number">6.4. </span>配置接口trunk模式并验证连通性<a class="headerlink" href="#id12" title="永久链接至标题"></a></h2>
<section id="switch0switch1trunk">
<h3><span class="section-number">6.4.1. </span>配置Switch0和Switch1的trunk端口<a class="headerlink" href="#switch0switch1trunk" title="永久链接至标题"></a></h3>
<p>将Switch0与Switch1的g0/0/4接口模式配置为trunk，使得所有VLAN都可以通过。
在Switch0交换机下使用下列命令进行配置：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/4 //进入g0/0/4接口</span>
<span class="linenos">2</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#no switchport access vlan // 删除端口下的vlan配置</span>
<span class="linenos">3</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport mode trunk //把端口的连接类型设置为trunk模式</span>
<span class="linenos">4</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport trunk allowed vlan 2,3 // 允许Trunk接口模式下vlan2,3的数据通过</span>
<span class="linenos">5</span>Switch0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">6</span>Switch0<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">7</span>Switch0#
</pre></div>
</div>
<p>使用show running-config命令查看配置命令</p>
<a class="reference internal image-reference" href="../_images/conf-21.png"><img alt="../_images/conf-21.png" src="../_images/conf-21.png" style="width: 344.8px; height: 450.40000000000003px;" /></a>
<p>在SW1交换机下使用下列命令进行配置：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/4 //进入g0/0/4接口</span>
<span class="linenos">2</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#no switchport access vlan</span>
<span class="linenos">3</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport mode trunk //把端口的连接类型设置为trunk模式</span>
<span class="linenos">4</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#switchport trunk allowed vlan 2,3</span>
<span class="linenos">5</span>Switch1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">6</span>Switch1<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">7</span>Switch1#
</pre></div>
</div>
<p>使用show running-config命令查看配置命令</p>
<a class="reference internal image-reference" href="../_images/conf-22.png"><img alt="../_images/conf-22.png" src="../_images/conf-22.png" style="width: 400.0px; height: 450.40000000000003px;" /></a>
</section>
<section id="id13">
<h3><span class="section-number">6.4.2. </span>观察VLAN 3的连通情况<a class="headerlink" href="#id13" title="永久链接至标题"></a></h3>
<p>在PC1上使用ping PC3命令测试连通性，如图：</p>
<a class="reference internal image-reference" href="../_images/conf-23.png"><img alt="../_images/conf-23.png" src="../_images/conf-23.png" style="width: 681.6px; height: 584.8000000000001px;" /></a>
</section>
<section id="id14">
<h3><span class="section-number">6.4.3. </span>观察同一VLAN和不同VLAN的连通情况<a class="headerlink" href="#id14" title="永久链接至标题"></a></h3>
<p>在PC0上使用ping PC2命令测试连通性，在PC0上使用ping PC3命令测试连通性，如图:</p>
<a class="reference internal image-reference" href="../_images/conf-24.png"><img alt="../_images/conf-24.png" src="../_images/conf-24.png" style="width: 681.6px; height: 601.6px;" /></a>
<p>完成trunk模式配置后，PC0和PC2互通，PC1和PC3互通，PC0和PC3不连通。</p>
<div class="admonition hint">
<p class="admonition-title">提示</p>
<p>如果实验结果不对，请参照下列方法来 <strong>调试和排错</strong></p>
<ol class="arabic simple">
<li><p>检查交换机与交换机之间的端口是否配置为Trunk模式。</p></li>
<li><p>检查各端口华为的VLAN是否正确。</p></li>
<li><p>一般来说，交换机等设备都具有自适应性，即支持直通线和交叉线混用，但在使用Cisco Packet Tracer模拟器软件时，要注意直通线和交叉线的区别，二者不能混用。</p></li>
</ol>
</div>
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p><strong>思考题</strong></p>
<p>下图中Switch0的Fa0/1和Fa0/4属于同一个VLAN 2，Switch1的Fa0/1和Fa0/4属于同一个VLAN 3，这四个端口都是access口，试验结果PC0和PC1能互通，请问属于不同VLAN中的PC0和PC1为什么也能通，当把Switch0的Fa0/4和Switch1的Fa0/4改成trunk模式反而不通？请分析其原因，并写入实验报告中。</p>
<img alt="../_images/conf-26.png" src="../_images/conf-26.png" />
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Lab1：VLAN 与接口模式配置" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../lab2/index.html" class="btn btn-neutral float-right" title="Lab2：协议栈之Eth协议实现" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, qiu.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>