<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. 实验目的 &mdash; 计算机网络实验指导书 - 2022春季 | 哈工大（深圳） v1.0 文档</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/my_style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
        <script src="../_static/js/baidu-tongji.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Lab5：协议栈之IP协议实现" href="../lab5/index.html" />
    <link rel="prev" title="Lab4：RIP路由配置及协议分析" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> 计算机网络实验指导书 - 2022春季 | 哈工大（深圳）
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">实验</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../lab0/index.html">计算机网络实验概述</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab4/index.html">Lab1：VLAN 与接口模式配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab2/index.html">Lab2：协议栈之Eth协议实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab3/index.html">Lab3：协议栈之ARP协议实现</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Lab4：RIP路由配置及协议分析</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1. 实验目的</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">2. 实验任务</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">3. 实验原理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rip">3.1. RIP概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">3.2. RIP协议特点</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">3.3. RIP报文格式</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id6">4. 实验环境与分组</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">5. 实验组网</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">6. 实验步骤</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">6.1. 搭建网络拓扑</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pcip">6.2. 配置三台PC的IP地址</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">6.3. 配置路由器、交换机基本信息和计算机的网关</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#r0ip">6.3.1. 在路由器R0上配置端口的IP地址</a></li>
<li class="toctree-l4"><a class="reference internal" href="#r0">6.3.2. 查看R0路由表</a></li>
<li class="toctree-l4"><a class="reference internal" href="#r1ip">6.3.3. 在路由器R1上配置端口的IP地址</a></li>
<li class="toctree-l4"><a class="reference internal" href="#r1-r0r1">6.3.4. 查看R1路由表，并观察R0和R1的连通性</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">6.3.5. 配置三台计算机的网关</a></li>
<li class="toctree-l4"><a class="reference internal" href="#r0ping-r1">6.3.6. 在R0上ping R1验证连通性</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pc0ping-r0">6.3.7. 在PC0上ping R0验证连通性</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pc1ping-r1">6.3.8. 在PC1上ping R1验证连通性</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pc0ping-pc1">6.3.9. 在PC0上ping PC1验证连通性</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id12">6.4. 配置RIP协议及查看路由表，并测试连通性</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#r0rip">6.4.1. 在路由器R0上启用RIP协议</a></li>
<li class="toctree-l4"><a class="reference internal" href="#r1rip">6.4.2. 路由器R1上启用RIP协议</a></li>
<li class="toctree-l4"><a class="reference internal" href="#r0r1">6.4.3. 查看R0和R1的路由表</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pc0pc1">6.4.4. 测试PC0到PC1之间的连通性</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id13">6.5. 触发更新和水平分割</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14">6.5.1. 进入仿真调试模式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">6.5.2. 观察触发更新报文</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">6.5.3. 观察取消水平分割前后报文差异</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lab5/index.html">Lab5：协议栈之IP协议实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab6/index.html">Lab6：协议栈之ICMP协议实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab7/index.html">Lab7：协议栈之UDP协议实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab10/index.html">Lab8：NAT组网</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab9/index.html">Lab9：邮件客户端的设计与实现</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proplus/index.html">附加题</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">附录</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix-a/index.html">附录 A：Wireshark 入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix-b/index.html">附录 B：网络编程实验环境</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix-c/index.html">附录 C：Cisco Packet Tracer简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix-d/index.html">附录 D：参考文献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix-e/index.html">附录 E：致谢</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix-f/index.html">常见问题</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">计算机网络实验指导书 - 2022春季 | 哈工大（深圳）</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Lab4：RIP路由配置及协议分析</a> &raquo;</li>
      <li><span class="section-number">1. </span>实验目的</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/lab8/1cisco-rip.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1><span class="section-number">1. </span>实验目的<a class="headerlink" href="#id1" title="永久链接至标题"></a></h1>
<ol class="arabic simple">
<li><p>了解动态路由协议的原理与应用。</p></li>
<li><p>熟悉RIP协议的特点，理解水平分割、触发更新和毒性逆转的作用。</p></li>
<li><p>掌握RIP协议的配置方法。</p></li>
</ol>
</section>
<section id="id2">
<h1><span class="section-number">2. </span>实验任务<a class="headerlink" href="#id2" title="永久链接至标题"></a></h1>
<p>掌握RIP的配置方法，在cisc packet tracer上截取RIP报文，理解触发更新和水平分割对RIP收敛速度和避免环路的作用。</p>
</section>
<section id="id3">
<h1><span class="section-number">3. </span>实验原理<a class="headerlink" href="#id3" title="永久链接至标题"></a></h1>
<section id="rip">
<h2><span class="section-number">3.1. </span>RIP概要<a class="headerlink" href="#rip" title="永久链接至标题"></a></h2>
<p>RIP（Routing Information Protocol）是基于距离矢量算法的一种路由协议，它使用“跳数”，即指所经过的路由器的个数来衡量到达目标地址的路由距离，广泛应用于LAN。BSD UNIX系统的routed进程采用了RIP协议，由此RIP得到了迅速的普及。</p>
</section>
<section id="id4">
<h2><span class="section-number">3.2. </span>RIP协议特点<a class="headerlink" href="#id4" title="永久链接至标题"></a></h2>
<p>RIP协议特点可归纳如下：</p>
<ol class="arabic simple">
<li><p>30秒一次，将自己所知道的路由信息广播出去。如果一个路由在180秒内未被刷，就认为网络被断开。</p></li>
<li><p>根据距离向量生成路由控制表。路由控制表针对同一个网络如果有两条路径，那么选择距离较短的一个。如果距离相等，通常是随机选择一个或是轮换使用。</p></li>
</ol>
<p>但是，这两个特点使得RIP明显存在一些问题。如下图所示，当网络A存在通信故障时，路由器A虽然认为自己与网络A的连接已经断开了，但是它还会收到路由器B曾经获知的路由消息，这就会让路由器A误认为还可以通过路由器B到达网络A。这样就会导致无限计数（Counting to Infinity），出现路由环路。</p>
<img alt="../_images/RIP1.png" src="../_images/RIP1.png" />
<img alt="../_images/RIP2.png" src="../_images/RIP2.png" />
<img alt="../_images/RIP3.png" src="../_images/RIP3.png" />
<p>为了解决这个问题，RIP采取以下两种方法：</p>
<ol class="arabic simple">
<li><p>最长跳数不超过16（16被定义成无穷大，即目标网络或主机不可达）。这个信息只保留120秒。一旦超过这个时间，信息将被删除。</p></li>
<li><p>采用 <strong>水平分割</strong> （Split Horizon）方法，即路由器不在把所收到的路由信息原路返回给发送端。</p></li>
</ol>
<p>然而，在环路有多余的情况下，需要很长时间才能产生正确的路由信息。在有些情况下（比如帧中继Hub-spoke网络结构、X.25等非广播多路访问网络）需要关闭水平分割，否则将无法正常传递路由信息。</p>
<p>为了尽可能解决这个问题，RIP又提供了毒性逆转（Posion Reverse）和触发更新（Triggered Update）机制。</p>
<p><strong>毒性逆转</strong> 是水平分割的一种变型。当网络发送故障时，它不是不再发送这个消息，而是发送一个距离为16的消息。</p>
<p><strong>触发更新</strong> 是指当网络发生变化时，路由器就立即发送其新的路由表，而不是等待30秒。</p>
<div class="admonition hint">
<p class="admonition-title">提示</p>
<p>通过上述方法，RIP的最大网络范围在16跳以内，而且路由器想要达到一个稳定的状态也需要花一段时间。如果想要明确地掌握网络结构，可以采用路由协议相对复杂的OSPF（Open Short Path First）路由协议，在本实验中不做重点介绍。</p>
</div>
</section>
<section id="id5">
<h2><span class="section-number">3.3. </span>RIP报文格式<a class="headerlink" href="#id5" title="永久链接至标题"></a></h2>
<p>RIP协议使用UDP协议的520端口来发送和接收RIP报文。其报文格式如下图所示。</p>
<img alt="../_images/RIP格式.png" src="../_images/RIP格式.png" />
<ol class="arabic simple">
<li><p>命令字(Command)：1为请求报文，2为应答报文。</p></li>
<li><p>版本 (Version)：指生成RIP报文时所使用的版本，RIP只有两个版本:版本1和版本2。</p></li>
<li><p>路由选择域 (Routing Domain)：路由域标号为0的是缺省的路由域。</p></li>
<li><p>地址族标识（Address Family Identifier）：报文中所携带地址的类型，提供了和以前版本的兼容性。IP协议簇对应的值为2，该字段使RIP可以用于多种不同的协议簇。</p></li>
<li><p>路由标记(Route Tag)  ：用于传递自治系统的标号。</p></li>
<li><p>IP地址(IP Address)：可以是主机、网格，甚至是一个缺省网关地址。</p></li>
<li><p>子网掩码(Subnet Mask)：子网掩码信息是RIP协议在多种环境中变得更有用，并且允许在网络中使用变长掩码。</p></li>
<li><p>下一跳地址(Next Hop)：支持下一跳地址优化了在使用多种路由协议的网络环境中的路由器。</p></li>
<li><p>度量值（Metric）：这个值经过路由器时被递增。数量标准有效的范围是在1～15之间。</p></li>
</ol>
</section>
</section>
<section id="id6">
<h1><span class="section-number">4. </span>实验环境与分组<a class="headerlink" href="#id6" title="永久链接至标题"></a></h1>
<p>cisco packet tracer模拟器，一人一组。</p>
</section>
<section id="id7">
<h1><span class="section-number">5. </span>实验组网<a class="headerlink" href="#id7" title="永久链接至标题"></a></h1>
<img alt="../_images/cisco-110.png" src="../_images/cisco-110.png" />
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>上述组网图中存在四种类型局域网，分别是1.1.1.1/32、192.168.1.0/24、192.168.2.0/24、192.168.3.0/24。</p>
<p>Loopback是一种纯软件性质的虚拟接口，Loopback接口一旦被创建，将一直保持UP状态，直到被删除。路由器和三层交换机都可以配置Loopback接口。</p>
</div>
<p>IP地址表：</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>设备名称</p></th>
<th class="head"><p>IP地址</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>R0-f0/1</p></td>
<td><p>192.168.2.1/24</p></td>
</tr>
<tr class="row-odd"><td><p>R0-f0/0</p></td>
<td><p>192.168.1.1/24</p></td>
</tr>
<tr class="row-even"><td><p>R1-f0/1</p></td>
<td><p>192.168.3.1/24</p></td>
</tr>
<tr class="row-odd"><td><p>R1-f0/0</p></td>
<td><p>192.168.1.2/24</p></td>
</tr>
<tr class="row-even"><td><p>R1-loopback 1</p></td>
<td><p>1.1.1.1/32</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id8">
<h1><span class="section-number">6. </span>实验步骤<a class="headerlink" href="#id8" title="永久链接至标题"></a></h1>
<section id="id9">
<h2><span class="section-number">6.1. </span>搭建网络拓扑<a class="headerlink" href="#id9" title="永久链接至标题"></a></h2>
<p>打开Cisco Packet Tracer软件绘制出组网图。</p>
<p>路由器型号：1841
交换机型号：2960</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>路由器和路由器之间的连接线需要使用Copper Cross Over(交叉线)。交换机和路由器、交换机和计算机使用Copper Straight-Through(直通线)</p>
<p>搭建完网络拓扑图后，记得保存好！</p>
</div>
</section>
<section id="pcip">
<h2><span class="section-number">6.2. </span>配置三台PC的IP地址<a class="headerlink" href="#pcip" title="永久链接至标题"></a></h2>
<p>按照下表设置PC0、PC1和PC2这三台电脑的IP地址。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>计算机</p></th>
<th class="head"><p>IP地址</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PC0</p></td>
<td><p>192.168.2.11/24</p></td>
</tr>
<tr class="row-odd"><td><p>PC1</p></td>
<td><p>192.168.3.13/24</p></td>
</tr>
<tr class="row-even"><td><p>PC2</p></td>
<td><p>192.168.3.14/24</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id10">
<h2><span class="section-number">6.3. </span>配置路由器、交换机基本信息和计算机的网关<a class="headerlink" href="#id10" title="永久链接至标题"></a></h2>
<section id="r0ip">
<span id="loopback"></span><h3><span class="section-number">6.3.1. </span>在路由器R0上配置端口的IP地址<a class="headerlink" href="#r0ip" title="永久链接至标题"></a></h3>
<p>路由器在第一次配置时会启动配置向导界面，通常选择no，不进入对话模式，而是直接进入正常配置模式。</p>
<a class="reference internal image-reference" href="../_images/cisco-25.png"><img alt="../_images/cisco-25.png" src="../_images/cisco-25.png" style="width: 525.6px; height: 504.0px;" /></a>
<p>配置R0的基本信息。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>Router&gt;enable
<span class="linenos"> 2</span>Router#configure terminal
<span class="linenos"> 3</span>Router<span class="o">(</span>config<span class="o">)</span><span class="c1">#hostname R0 // 重命名为R0</span>
<span class="linenos"> 4</span>Router<span class="o">(</span>config<span class="o">)</span><span class="c1">#no ip domain-lookup  // 用于防止DNS解析的命令。如果没有这条命令，当你输入错误的命令时，cisco会尝试连接DNS服务器进行域名解析，浪费时间。</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>R0<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/0  // 打开f0/0接口（默认接口关闭）</span>
<span class="linenos"> 7</span>R0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#ip address 192.168.1.1 255.255.255.0 //配置f0/0接口ip地址</span>
<span class="linenos"> 8</span>R0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#no shutdown // 打开f0/0接口</span>
<span class="linenos"> 9</span>R0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">10</span>
<span class="linenos">11</span>R0<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/1  // 进入f0/1接口模式</span>
<span class="linenos">12</span>R0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#ip address 192.168.2.1 255.255.255.0 //配置f0/1接口ip地址</span>
<span class="linenos">13</span>R0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#no shutdown  // 打开f0/1接口（默认接口关闭）</span>
<span class="linenos">14</span>R0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">15</span>
<span class="linenos">16</span>R0<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface loopback 1  //配置Loopback回环接口</span>
<span class="linenos">17</span>R0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#ip address 1.1.1.1 255.255.255.255 //配置回环地址</span>
<span class="linenos">18</span>R0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">19</span>R0<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
</pre></div>
</div>
</section>
<section id="r0">
<h3><span class="section-number">6.3.2. </span>查看R0路由表<a class="headerlink" href="#r0" title="永久链接至标题"></a></h3>
<a class="reference internal image-reference" href="../_images/cisco-32.png"><img alt="../_images/cisco-32.png" src="../_images/cisco-32.png" style="width: 664.0px; height: 217.60000000000002px;" /></a>
</section>
<section id="r1ip">
<h3><span class="section-number">6.3.3. </span>在路由器R1上配置端口的IP地址<a class="headerlink" href="#r1ip" title="永久链接至标题"></a></h3>
<p>配置R1的基本信息</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>Router&gt;enable
<span class="linenos"> 2</span>Router#configure terminal
<span class="linenos"> 3</span>Router<span class="o">(</span>config<span class="o">)</span><span class="c1">#hostname R1 // 重命名为R1</span>
<span class="linenos"> 4</span>Router<span class="o">(</span>config<span class="o">)</span><span class="c1">#no ip domain-lookup  // 用于防止DNS解析的命令。</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span>R1<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/0  // 进入f0/0接口模式</span>
<span class="linenos"> 8</span>R1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#ip address 192.168.1.2 255.255.255.0 //配置f0/0接口ip地址</span>
<span class="linenos"> 9</span>R1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#no shutdown  // 打开f0/0接口</span>
<span class="linenos">10</span>R1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">11</span>
<span class="linenos">12</span>R1<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/1  // 进入f0/1接口模式</span>
<span class="linenos">13</span>R1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#ip address 192.168.3.1 255.255.255.0 //配置f0/1接口ip地址</span>
<span class="linenos">14</span>R1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#no shutdown  // 打开f0/1接口</span>
<span class="linenos">15</span>R1<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">16</span>R1<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">17</span>R1#
</pre></div>
</div>
</section>
<section id="r1-r0r1">
<h3><span class="section-number">6.3.4. </span>查看R1路由表，并观察R0和R1的连通性<a class="headerlink" href="#r1-r0r1" title="永久链接至标题"></a></h3>
<a class="reference internal image-reference" href="../_images/cisco-42.png"><img alt="../_images/cisco-42.png" src="../_images/cisco-42.png" style="width: 659.2px; height: 220.8px;" /></a>
<p>R1配置完成后，R0和R1已经连通。此时，再次查看R0路由表，已经可以看到有192.168.1.0/24网段了。</p>
<a class="reference internal image-reference" href="../_images/cisco-52.png"><img alt="../_images/cisco-52.png" src="../_images/cisco-52.png" style="width: 654.4000000000001px; height: 242.4px;" /></a>
</section>
<section id="id11">
<h3><span class="section-number">6.3.5. </span>配置三台计算机的网关<a class="headerlink" href="#id11" title="永久链接至标题"></a></h3>
<p>PC0网关为192.168.2.1</p>
<a class="reference internal image-reference" href="../_images/cisco-62.png"><img alt="../_images/cisco-62.png" src="../_images/cisco-62.png" style="width: 681.6px; height: 601.6px;" /></a>
<p>PC1和PC2网关为192.168.3.1，配置方法和PC0一样。</p>
<p>PC0通过默认网关将发往未知网络的数据交由R0处理。同理PC1和PC2通过默认网关将数据交给R1。</p>
</section>
<section id="r0ping-r1">
<h3><span class="section-number">6.3.6. </span>在R0上ping R1验证连通性<a class="headerlink" href="#r0ping-r1" title="永久链接至标题"></a></h3>
<a class="reference internal image-reference" href="../_images/cisco-72.png"><img alt="../_images/cisco-72.png" src="../_images/cisco-72.png" style="width: 582.4px; height: 107.2px;" /></a>
</section>
<section id="pc0ping-r0">
<h3><span class="section-number">6.3.7. </span>在PC0上ping R0验证连通性<a class="headerlink" href="#pc0ping-r0" title="永久链接至标题"></a></h3>
<a class="reference internal image-reference" href="../_images/cisco-82.png"><img alt="../_images/cisco-82.png" src="../_images/cisco-82.png" style="width: 681.6px; height: 601.6px;" /></a>
</section>
<section id="pc1ping-r1">
<h3><span class="section-number">6.3.8. </span>在PC1上ping R1验证连通性<a class="headerlink" href="#pc1ping-r1" title="永久链接至标题"></a></h3>
<a class="reference internal image-reference" href="../_images/cisco-91.png"><img alt="../_images/cisco-91.png" src="../_images/cisco-91.png" style="width: 681.6px; height: 601.6px;" /></a>
</section>
<section id="pc0ping-pc1">
<h3><span class="section-number">6.3.9. </span>在PC0上ping PC1验证连通性<a class="headerlink" href="#pc0ping-pc1" title="永久链接至标题"></a></h3>
<a class="reference internal image-reference" href="../_images/cisco-101.png"><img alt="../_images/cisco-101.png" src="../_images/cisco-101.png" style="width: 681.6px; height: 601.6px;" /></a>
<p>此时，还没有设置RIP路由协议，PC0和PC1还不能相互连通。</p>
</section>
</section>
<section id="id12">
<h2><span class="section-number">6.4. </span>配置RIP协议及查看路由表，并测试连通性<a class="headerlink" href="#id12" title="永久链接至标题"></a></h2>
<p>为两台路由器配置RIP协议，并通告其网络。具体命令如下：</p>
<section id="r0rip">
<h3><span class="section-number">6.4.1. </span>在路由器R0上启用RIP协议<a class="headerlink" href="#r0rip" title="永久链接至标题"></a></h3>
<p>在R0的全局模式下配置：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>R0<span class="o">(</span>config<span class="o">)</span><span class="c1">#router rip  //启用RIP协议</span>
<span class="linenos">2</span>R0<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#version 2 // 设置版本号为RIP v2</span>
<span class="linenos">3</span>
<span class="linenos">4</span>R0<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#network 192.168.1.0  //通告直连网段，在网段192.168.1.0上启动RIP</span>
<span class="linenos">5</span>R0<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#network 192.168.2.0  //通告直连网段，在网段192.168.2.0上启动RIP</span>
<span class="linenos">6</span>R0<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#network 1.0.0.0  //通告直连网段，在网段1.0.0.0上启动RIP</span>
<span class="linenos">7</span>R0<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#no auto-summary  //关闭自动汇总功能</span>
<span class="linenos">8</span>R0<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">9</span>R0<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
</pre></div>
</div>
</section>
<section id="r1rip">
<h3><span class="section-number">6.4.2. </span>路由器R1上启用RIP协议<a class="headerlink" href="#r1rip" title="永久链接至标题"></a></h3>
<p>在R2全局模式下配置：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>R1<span class="o">(</span>config<span class="o">)</span><span class="c1">#router rip  //启用RIP协议</span>
<span class="linenos">2</span>R1<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#version 2  // 设置版本号为RIP v2</span>
<span class="linenos">3</span>
<span class="linenos">4</span>R1<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#network 192.168.1.0  //通告直连网段，在网段192.168.1.0上启动RIP</span>
<span class="linenos">5</span>R1<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#network 192.168.3.0  //通告直连网段，在网段192.168.3.0上启动RIP</span>
<span class="linenos">6</span>R1<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#no auto-summary  //关闭自动汇总功能</span>
<span class="linenos">7</span>R1<span class="o">(</span>config-router<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">8</span>R1<span class="o">(</span>config<span class="o">)</span><span class="c1">#exit</span>
<span class="linenos">9</span>R1#
</pre></div>
</div>
</section>
<section id="r0r1">
<h3><span class="section-number">6.4.3. </span>查看R0和R1的路由表<a class="headerlink" href="#r0r1" title="永久链接至标题"></a></h3>
<p>R0路由表:</p>
<a class="reference internal image-reference" href="../_images/cisco-121.png"><img alt="../_images/cisco-121.png" src="../_images/cisco-121.png" style="width: 652.8000000000001px; height: 251.20000000000002px;" /></a>
<p>此时，R0上多了一条RIP路由信息，即要达到192.168.3.0/24网段，下一个转发端口是192.168.1.2。</p>
<p>R1路由表:</p>
<a class="reference internal image-reference" href="../_images/cisco-112.png"><img alt="../_images/cisco-112.png" src="../_images/cisco-112.png" style="width: 728.8000000000001px; height: 580.0px;" /></a>
<p>此时，R1上多了两条RIP路由信息。</p>
</section>
<section id="pc0pc1">
<h3><span class="section-number">6.4.4. </span>测试PC0到PC1之间的连通性<a class="headerlink" href="#pc0pc1" title="永久链接至标题"></a></h3>
<a class="reference internal image-reference" href="../_images/cisco-131.png"><img alt="../_images/cisco-131.png" src="../_images/cisco-131.png" style="width: 681.6px; height: 601.6px;" /></a>
<p>配置RIP路由协议后，PC0能访问到PC1了。</p>
</section>
</section>
<section id="id13">
<h2><span class="section-number">6.5. </span>触发更新和水平分割<a class="headerlink" href="#id13" title="永久链接至标题"></a></h2>
<section id="id14">
<h3><span class="section-number">6.5.1. </span>进入仿真调试模式<a class="headerlink" href="#id14" title="永久链接至标题"></a></h3>
<p>在Cisco Packet Tracer软件菜单栏View -&gt; Simulation Mode，在工作区的右边出现一个“Simulation Panel”，此时就进入了仿真模式。</p>
<a class="reference internal image-reference" href="../_images/cisco-141.png"><img alt="../_images/cisco-141.png" src="../_images/cisco-141.png" style="width: 559.2px; height: 264.8px;" /></a>
<p>在“Event List Filters-Visible Events”窗口栏中显示捕获的协议，这里面有很多是我们不需要观察的协议。单击Show All/None，Event List Filters-Visible Events窗口栏中变成None。然后，再点击Edit Filters。在弹出的窗口里，选择IPv4选项卡，选择ARP、ICMP、RIP这三种协议，本实验只需观察这三种协议即可。</p>
<a class="reference internal image-reference" href="../_images/cisco-151.png"><img alt="../_images/cisco-151.png" src="../_images/cisco-151.png" style="width: 395.20000000000005px; height: 160.8px;" /></a>
<p>单击“Play”三角形按钮，让网络设备开始运行。此时，我们可以观察数据包的传输过程。包转发需要一些时间，请耐心等待。</p>
<a class="reference internal image-reference" href="../_images/cisco-161.png"><img alt="../_images/cisco-161.png" src="../_images/cisco-161.png" style="width: 556.8000000000001px; height: 173.60000000000002px;" /></a>
<img alt="../_images/cisco-171.png" src="../_images/cisco-171.png" />
<p>上图中，在17.482s时刻，从Router0发出来了两个RIP数据包。点击“forward”前向三角按钮，在17.483s，这两个数据包分别被传输到Switch0和Router1。再次点击“forward”前向三角按钮，数据包在17.484s到达PC0，而之前到达Router1的数据没有在此时转发出来。这是因为Router1收到RIP协议数据包后，需要更新自身的路由表，然后等到它的下一个发包时刻再转发出路由数据包。22.991s，此时轮到Router1对外转发它的路由信息。22.992s数据包分别到达Router0和Switch1。由此我们可以观察数据包的传输过程。</p>
<p>在上图中，我们可以看到Router0第一次发出RIP数据包是在17.482s，第二次发送RIP数据包是在45.467s，第三次是在74.955s，相差间隔差不多是30s，这也验证了RIP是每30s将自己所知道的路由信息广播出去。</p>
</section>
<section id="id15">
<h3><span class="section-number">6.5.2. </span>观察触发更新报文<a class="headerlink" href="#id15" title="永久链接至标题"></a></h3>
<p>单击“Play”键停止抓包，然后单击“Reset Simulation”清空抓包信息。</p>
<p>再按下“Play”键开始抓包。然后在R1上使用命令no interface loopback1断开回环地址loopback 1，此时Simultaion Panel面板上显示结果如下:</p>
<img alt="../_images/cisco-181.png" src="../_images/cisco-181.png" />
<p>图中，21.263s，Router0发出两个RIP数据包。当我们输入no interface loopback 1命令断开loopback 1时，在21.265s，Router0又发出两个RIP数据包。此时，距离上一个Router0发出数据的时间还没有到达30s。</p>
<p>单击21.265s行的Router0，在弹出窗口的Outbound PDU Details选项卡中，可以看到这个RIP数据包携带有达到1.1.1.1网络的跳数为16，也就是不可达。21.266s，到达Router1后，Router1也立刻转发该路由信息。也就是，一条路有切断，全网通告。</p>
<a class="reference internal image-reference" href="../_images/cisco-191.png"><img alt="../_images/cisco-191.png" src="../_images/cisco-191.png" style="width: 560.0px; height: 564.0px;" /></a>
<p>由此可知，在网络发生改变时，RIP路由协议会及时触发更新，而不是等到下一个30s后才发出路由信息。</p>
</section>
<section id="id16">
<h3><span class="section-number">6.5.3. </span>观察取消水平分割前后报文差异<a class="headerlink" href="#id16" title="永久链接至标题"></a></h3>
<p>参照上述配置方式 <a class="reference internal" href="#loopback"><span class="std std-ref">在路由器R0上配置端口的IP地址</span></a>，重新配置好loopback 1。</p>
<p>单击“Play”键停止抓包，然后单击“Reset Simulation”清空抓包信息。再按下“Play”键开始抓包。接下来，我们观察打开/关闭水平分割的报文。</p>
<p>我们找到从Router0发出到Switch0的RIP数据包。以下图为例，在8.120s，Switch0收到的RIP路由信息有两条，显示到达192.168.1.0网段需要1跳，到达192.168.3.0网段需要2跳。</p>
<img alt="../_images/cisco-201.png" src="../_images/cisco-201.png" />
<p>同样在8.120s，Router1也收到Router0的RIP数据包，在该数据包中，只有到达1.1.1.1网段和192.168.2.0的路由信息，没有192.168.1.0网段和192.168.3.0网段的路由信息。这是因为开启了水平分割（rip配置后默认启动水平分割），Router0是从F0/0端口接收学习到192.168.1.0网段和192.168.3.0网段的路由信息，就不会再从该接口发回去。</p>
<img alt="../_images/cisco-212.png" src="../_images/cisco-212.png" />
<p>接着，取消Router0的水平分割，我们继续观察RIP数据包。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>R0<span class="o">(</span>config<span class="o">)</span><span class="c1">#interface f0/0</span>
<span class="linenos">2</span>R0<span class="o">(</span>config-if<span class="o">)</span><span class="c1">#no ip split-horizon</span>
</pre></div>
</div>
<img alt="../_images/cisco-221.png" src="../_images/cisco-221.png" />
<p>如上图所示，在取消水平分割后，Router1收到Router0的4条路由协议，多了2条来自192.168.1.0和192.168.3.0的报文。</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Lab4：RIP路由配置及协议分析" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../lab5/index.html" class="btn btn-neutral float-right" title="Lab5：协议栈之IP协议实现" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, qiu.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>